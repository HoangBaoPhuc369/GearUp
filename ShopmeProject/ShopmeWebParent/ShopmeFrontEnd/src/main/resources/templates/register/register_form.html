<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<head th:replace="fragments :: html_head('none')"></head>

<body>
  <div class="content-wrapper">
    <header class="wrapper bg-soft-primary">
      <nav class="navbar navbar-expand-lg center-nav transparent position-absolute navbar-dark">
        <div class="container flex-lg-row flex-nowrap align-items-center">
          <div class="navbar-brand w-100">
            <a href="./index.html">
              <img class="logo-dark" src="./assets/img/logo.png" srcset="./assets/img/logo@2x.png 2x" alt="" />
              <img class="logo-light" src="./assets/img/logo-light.png" srcset="./assets/img/logo-light@2x.png 2x" alt="" />
            </a>
          </div>
          <div class="navbar-collapse offcanvas offcanvas-nav offcanvas-start">
            <div class="offcanvas-header d-lg-none">
              <h3 class="text-white fs-30 mb-0">Sandbox</h3>
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
          
            <!-- /.offcanvas-body -->
          </div>
          <!-- /.navbar-collapse -->
          <div class="navbar-other w-100 d-flex ms-auto">
            <ul class="navbar-nav flex-row align-items-center ms-auto">
              <li class="nav-item dropdown language-select text-uppercase">
                <a class="nav-link dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">En</a>
                <ul class="dropdown-menu">
                  <li class="nav-item"><a class="dropdown-item" href="#">En</a></li>
                  <li class="nav-item"><a class="dropdown-item" href="#">De</a></li>
                  <li class="nav-item"><a class="dropdown-item" href="#">Es</a></li>
                </ul>
              </li>
              <li class="nav-item d-none d-md-block">
                <a href="./contact.html" class="btn btn-sm btn-white rounded-pill">Contact</a>
              </li>
              <li class="nav-item d-lg-none">
                <button class="hamburger offcanvas-nav-btn"><span></span></button>
              </li>
            </ul>
            <!-- /.navbar-nav -->
          </div>
          <!-- /.navbar-other -->
        </div>
        <!-- /.container -->
      </nav>
      <!-- /.navbar -->
    </header>
    <!-- /header -->
    <section class="wrapper bg-dark text-white">
      <div class="container pt-18 pt-md-20 pb-21 pb-md-21 text-center">
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <h1 class="display-1 text-white mb-3">Sign Up</h1>
            <nav class="d-inline-block" aria-label="breadcrumb">
              <ol class="breadcrumb text-white">
                <li class="breadcrumb-item"><a href="#">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">Sign Up</li>
              </ol>
            </nav>
            <!-- /nav -->
          </div>
          <!-- /column -->
        </div>
        <!-- /.row -->
      </div>
      <!-- /.container -->
    </section>
    <!-- /section -->
    <section class="wrapper bg-light">
      <div class="container pb-14 pb-md-16">
        <div class="row">
          <div class="col mt-n19">
            <div class="card shadow-lg">
              <div class="row gx-0 text-center">
                <div class="col-lg-6 image-wrapper bg-image bg-cover rounded-top rounded-lg-start d-none d-md-block" data-image-src="./assets/img/photos/tm3.jpg">
                </div>
                <!--/column -->
                <div class="col-lg-6">
                  <div class="p-10 p-md-11 p-lg-13">
                    <h2 class="mb-3 text-start">Sign up to Sandbox</h2>
                    <p class="lead mb-6 text-start">Registration takes less than a minute.</p>
                    <form class="text-start mb-3" th:action="@{/create_customer}" enctype="multipart/form-data" method="post" th:object="${customer}" onsubmit="return checkEmailUnique(this);">
                      <input type="hidden" th:field="*{id}" />
                      <div style="display: flex;">
                        <div class="form-floating mb-4" style="width: 50%;margin-right: 10px;">
                            <input type="text" th:field="*{firstName}" class="form-control"  
                                placeholder="Name"
                                required="required" maxlength="45" minlength="2">
                            <label for="loginName">firstName</label>
                          </div> 
                          <div class="form-floating mb-4" style="width: 50%;">
                            <input type="text" class="form-control" th:field="*{lastName}"  
                                placeholder="Name"  required="required" maxlength="45" minlength="2">
                            <label for="lastName">Last Name</label>
                          </div>
                      </div>
                    
                      <div style="display: flex;">
                            <div class="form-floating password-field mb-4" style="width: 50%;margin-right: 10px;">
                                <input type="password" th:field="*{password}" class="form-control" oninput="checkPasswordMatch(document.getElementById('confirmPassword'))" placeholder="Password"  maxlength="15" minlength="6">
                                <span class="password-toggle"><i class="uil uil-eye"></i></span>
                                <label for="password">Password</label>
                            </div>

                            <div class="form-floating password-field mb-4" style="width: 50%;">
                                <input type="password" class="form-control" oninput="checkPasswordMatch(this)" placeholder="Confirm Password" id="confirmPassword" maxlength="15" minlength="6">
                                <span class="password-toggle"><i class="uil uil-eye"></i></span>
                                <label for="confirmPassword">Confirm Password</label>
                            </div>
                     </div>

                     <div class="form-floating mb-4">
                        <input type="email" th:field="*{email}" class="form-control" 
                            placeholder="Email" maxlength="45" minlength="8">
                        <label for="email">Email</label>
                      </div>

                      <div class="form-floating mb-4">
                        <input type="text" th:field="*{phoneNumber}" class="form-control" 
                            placeholder="Phone number"  maxlength="15" minlength="8">
                        <label for="phoneNumber">Phone</label>
                      </div>
                      <button type="submit" class="btn btn-primary rounded-pill btn-login w-100 mb-2">Sign Up</button>
                    </form>
                    <!-- /form -->
                    <p class="mb-0">Already have an account? <a href="./signin2.html" class="hover">Sign in</a></p>
                    <!-- <div class="divider-icon my-4">or</div>
                    <nav class="nav social justify-content-center text-center">
                      <a href="#" class="btn btn-circle btn-sm btn-google"><i class="uil uil-google"></i></a>
                      <a href="#" class="btn btn-circle btn-sm btn-facebook-f"><i class="uil uil-facebook-f"></i></a>
                      <a href="#" class="btn btn-circle btn-sm btn-twitter"><i class="uil uil-twitter"></i></a>
                    </nav> -->
                    <!--/.social -->
                  </div>
                  <!--/div -->
                </div>
                <!--/column -->
              </div>
              <!--/.row -->
            </div>
            <!-- /.card -->
          </div>
          <!-- /column -->
        </div>
        <!-- /.row -->
      </div>
      <!-- /.container -->
    </section>
    <!-- /section -->
  </div>

  <!-- Modal -->
  <!-- <div class="modal fade" id="modal-notification" tabindex="-1" role="dialog" aria-labelledby="modal-notification" aria-hidden="true">
    <div class="modal-dialog modal-danger modal-dialog-centered modal-" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h6 class="modal-title text-gradient text-danger" id="modal-title-notification"></h6>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">Ã—</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="py-3 text-center">

            <div style="color: #fbb140;">
              <i class="fa-solid fa-circle-exclamation ni-3x"></i>
            </div>
            
            <h4 class="text-gradient text-danger mt-4">You should read this!</h4>
            <p id="modal-body-notification"></p>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn bg-gradient-warning" data-bs-dismiss="modal">Ok, Got it</button>
        </div>
      </div>
    </div>
  </div> -->

  <div class="modal fade" id="modal-notification" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-md">
      <div class="modal-content text-center">
        <div class="modal-body">
          <button class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          <div class="row">
            <div class="col-md-10 offset-md-1">
              <figure class="mb-6"><img th:src="@{/assets/img/illustrations/ui1.png}" th:attr="srcset=|/assets/img/illustrations/ui1@2x.png 2x|"  alt="" /></figure>
            </div>
            <!-- /column -->
          </div>
          <!-- /.row -->
          <h3 id="modal-title-notification" class="text-yellow"></h3>
          <p class="mb-6 text-red" id="modal-body-notification"></p>
          <div class="newsletter-wrapper">
            <div class="row">
              <div class="col-md-10 offset-md-1">
                <!-- Begin Mailchimp Signup Form -->
                <div id="mc_embed_signup">
                  <form action="https://elemisfreebies.us20.list-manage.com/subscribe/post?u=aa4947f70a475ce162057838d&amp;id=b49ef47a9a" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
                    <div id="mc_embed_signup_scroll">
                      <div class="mc-field-group input-group form-floating jus-end">
                        <div  class="btn btn-gradient gradient-6 rounded"  data-bs-dismiss="modal" aria-label="Close">Ok, I got it</div>
                      </div>
                      <div id="mce-responses" class="clear">
                        <div class="response" id="mce-error-response" style="display:none"></div>
                        <div class="response" id="mce-success-response" style="display:none"></div>
                      </div> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                      <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_ddc180777a163e0f9f66ee014_4b1bcfa0bc" tabindex="-1" value=""></div>
                      <div class="clear"></div>
                    </div>
                  </form>
                </div>
                <!--End mc_embed_signup-->
              </div>
              <!-- /.newsletter-wrapper -->
            </div>
            <!-- /column -->
          </div>
          <!-- /.row -->
        </div>
        <!--/.modal-body -->
      </div>
      <!--/.modal-content -->
    </div>
    <!--/.modal-dialog -->
  </div>
  <!--/.modal -->


  <!-- /.content-wrapper -->
  <div th:replace="footer :: footer"></div>
  <script th:src="@{/assets/js/plugins.js}"></script>
  <script th:src="@{/assets/js/theme.js}"></script>

  <script type="text/javascript">
      contextPath = "[[@{/}]]";

      function checkPasswordMatch(confirmPassword) {
        if(confirmPassword.value != $("#password").val()) {
          confirmPassword.setCustomValidity("Passwords do not match!");
        } else {
          confirmPassword.setCustomValidity("");
        }
      }


      function checkEmailUnique(form) {
      url = contextPath + "customers/check_unique_email";
      CustomerEmail = $("#email").val();
      csrfValue = $("input[name='_csrf']").val();

      params = {email: CustomerEmail, _csrf: csrfValue};

      $.post(url, params, function(response) {
        if(response == "OK") {
          form.submit();
        } else if (response == "Duplicated") {
          showModalNotification("Warnning", "Email already exist: " +" "+ CustomerEmail);
        } else {
          showModalNotification("Error", "Unknown response from server");
        }
      }).fail(function() {
        showModalNotification("Error", "Could not connect to the server");
      });

      function showModalNotification(title, message) {
          $("#modal-title-notification").text(title);
          $("#modal-body-notification").text(message);
          $("#modal-notification").modal("show");
      }

      return false;
    }
  </script>
</body>

</html>